function renderEmployeesTable(){
  const tb = document.getElementById('employeeTableBody');
  tb.innerHTML='';

  const list = employees
    .filter(e => !filterName || e.name.toLowerCase().includes(filterName));

  const now = new Date();
  const y = now.getFullYear();
  const m = now.getMonth() + 1;
  const daysInMonth = new Date(y, m, 0).getDate();

  list.forEach((e,i)=>{
    const { totalHours, compDays, leftover } = getMonthCompResult(e.id);

    // จ่ายเป็น "รายวันตามจำนวนวันจริงของเดือน" โดยใช้ 'วันชดเชย'
    const daily = e.monthlySalary / daysInMonth;
    const earned = (ALLOW_COMP ? compDays : 0) * daily;

    const performanceText = ALLOW_COMP
      ? `${compDays} วัน (คงเหลือ ${leftover.toFixed(2)} ชม., รวม ${totalHours.toFixed(2)} ชม.)`
      : `${totalHours.toFixed(2)} ชม. (ปิดโหมดชดเชย)` ;

    const tr=document.createElement('tr');
    tr.className='border-b border-sky-100 hover:bg-sky-50/50';
    tr.innerHTML = `
      <td class="px-4 py-3 text-xs md:text-sm">${i+1}</td>
      <td class="px-4 py-3 text-xs md:text-sm">${e.name}</td>
      <td class="px-4 py-3 text-xs md:text-sm">${e.monthlySalary.toLocaleString()} บาท</td>
      <td class="px-4 py-3 text-xs md:text-sm">${performanceText}</td>
      <td class="px-4 py-3 text-xs md:text-sm font-semibold text-emerald-700">
        ${earned.toLocaleString('th-TH',{maximumFractionDigits:2})} บาท
      </td>
      <td class="px-4 py-3 text-xs md:text-sm no-print">
        <button class="btn bg-rose-600 hover:bg-rose-700 text-white px-3 py-1 rounded-lg" onclick="deleteEmployee(${e.id})">ลบ</button>
      </td>
    `;
    tb.appendChild(tr);
  });

  document.getElementById('empCountShown').textContent =
    `แสดง ${list.length} / ทั้งหมด ${employees.length} คน`;
}
